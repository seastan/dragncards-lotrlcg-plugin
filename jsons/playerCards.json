{
    "automation": {
        "cards": {
            "4c4cccd3-576a-41f1-8b6c-ba11b4cc3d4b": {
                "_comment": "Celeborn",
                "rules": {
                    "celebornEnterPlayTokens": {
                        "_comment": "If Celeborn is in play, add tokens to Silvan allies that enter play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Silvan."], ["EQUAL", "$TARGET.currentFace.type", "Ally"]],
                        "then": [
                            ["LOG", "└── ", "Celeborn added 1 willpower, 1 attack, and 1 defense to ", "$TARGET.currentFace.name", " until the end of the round."],
                            ["ADD_TEMP_TOKEN", "round", "$TARGET_ID", "willpower", 1],
                            ["ADD_TEMP_TOKEN", "round", "$TARGET_ID", "attack", 1],
                            ["ADD_TEMP_TOKEN", "round", "$TARGET_ID", "defense", 1]
                        ]
                    }
                }
            },
            "afec8b6f-6838-442e-b2a8-71537a25e05d": {
                "_comment": "Celeborn",
                "inheritFrom": "4c4cccd3-576a-41f1-8b6c-ba11b4cc3d4b"
            },
            "bbab76d6-7554-40da-af74-fb502d08d9a8": {
                "_comment": "Tom Cotton",
                "rules": {
                    "tomCottonEnterPlayTokens": {
                        "_comment": "If Tom Cotton is in play, add tokens to Hobbit allies that enter play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Hobbit."], ["EQUAL", "$TARGET.currentFace.type", "Ally"]],
                        "then": [
                            ["LOG", "└── ", "Tom Cotton added 2 attack to ", "$TARGET.currentFace.name", " until the end of the round."],
                            ["ADD_TEMP_TOKEN", "round", "$TARGET_ID", "attack", 2]
                        ]
                    }
                }
            },
            "4124136c-8c86-4f86-830c-94c8c76df161": {
                "_comment": "Sam Gamgee",
                "ability": {
                    "A": [
                        ["LOG", "└── ", "Readied Sam Gamgee and added 1 willpower, 1 attack, and 1 defense until the end of the round."],
                        ["COND", "$THIS.exhausted", ["TOGGLE_EXHAUST", "$THIS"]],
                        ["ADD_TEMP_TOKEN", "round", "$THIS_ID", "willpower", 1],
                        ["ADD_TEMP_TOKEN", "round", "$THIS_ID", "attack", 1],
                        ["ADD_TEMP_TOKEN", "round", "$THIS_ID", "defense", 1]
                ]
                }
            },
            "6dc19efc-af54-4eff-b9ee-ee45e9fd4072": {
                "_comment": "Éowyn (Tactics)",
                "rules": {
                    "eowynSetup": {
                        "_comment": "Reduce starting threat by 3.",
                        "type": "trigger",
                        "side": "A",
                        "listenTo": ["/playerData/$THIS.controller/threat"],
                        "condition": ["AND", ["EQUAL", "$GAME.roundNumber", 0], ["PREV", ["EQUAL", "$GAME.playerData.{{$THIS.controller}}.threat", 0]]],
                        "then": [
                            ["VAR", "$NEW_THREAT", ["SUBTRACT", "$GAME.playerData.{{$THIS.controller}}.threat", 3]],
                            ["LOG", "└── ", "Éowyn reduced starting threat by 3 to {{$NEW_THREAT}}."],
                            ["DECREASE_VAL", "/playerData/{{$THIS.controller}}/threat", 3],
                            ["SET", "/cardById/$THIS_ID/usedEowynAbility", false]
                        ]
                    }
                },
                "ability": {
                    "A": ["COND",
                    ["AND", 
                        "$THIS.inPlay",
                        ["NOT", "$THIS.usedEowynAbility"]
                    ],
                    [
                        ["LOG", "└── ", "Readied Éowyn, increased threat by 3, and added 9 attack until the end of the phase."],
                        ["INCREASE_VAL", "/playerData/{{$THIS.controller}}/threat", 3],
                        ["COND", "$THIS.exhausted", ["TOGGLE_EXHAUST", "$THIS"]],
                        ["COND", "$THIS.exhausted", ["TOGGLE_EXHAUST", "$THIS"]],
                        ["ADD_TEMP_TOKEN", "phase", "$THIS_ID", "attack", 9],
                        ["SET", "/cardById/$THIS_ID/usedEowynAbility", true]
                    ],
                    ["TRUE"],
                    ["LOG", "└── ", "The ability's conditions are not met."]
                ]
                }
            },
            "151ba48a-1efd-451e-bba0-b49fa0566596": {
                "_comment": "Fatty Bolger (Lore, ALeP)",
                "rules": {
                    "fattySetup": {
                        "_comment": "Reduce starting threat by 2.",
                        "type": "trigger",
                        "side": "A",
                        "listenTo": ["/playerData/$THIS.controller/threat"],
                        "condition": ["AND", ["EQUAL", "$GAME.roundNumber", 0], ["PREV", ["EQUAL", "$GAME.playerData.{{$THIS.controller}}.threat", 0]]],
                        "then": [
                            ["VAR", "$NEW_THREAT", ["SUBTRACT", "$GAME.playerData.{{$THIS.controller}}.threat", 2]],
                            ["LOG", "└── ", "Fatty Bolger reduced starting threat by 2 to {{$NEW_THREAT}}."],
                            ["DECREASE_VAL", "/playerData/{{$THIS.controller}}/threat", 2]
                        ]
                    }
                }
            },
            "51223bd0-ffd1-11df-a976-0801206c9005": {
                "_comment": "Leadership Dain Ironfoot",
                "rules": {
                    "dainEnterPlayTokens": {
                        "_comment": "Add tokens to Dwarf characters that enter play if Dain is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND",
                            "$THIS.inPlay",
                            "$TARGET.inPlay",
                            ["PREV", ["NOT", "$TARGET.inPlay"]],
                            ["IN_STRING", "$TARGET.currentFace.traits", "Dwarf."],
                            ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"],
                            ["EQUAL", "$THIS.exhausted", false]
                        ],
                        "then": [
                            ["LOG", "└── ", "Dáin Ironfoot added 1 willpower and 1 attack to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/willpower", 1],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/attack", 1]
                        ]
                    },
                    "dainPassiveTokens": { 
                        "_comment": "Add/remove tokens on Dwarf characters depending on whether Dain is ready or not.",
                        "type": "whileInPlay", 
                        "side": "A",
                        "listenTo": ["/cardById/$THIS_ID/exhausted"],
                        "condition": ["EQUAL", "$THIS.exhausted", false],
                        "onDo": [
                            ["LOG", "└── ", "Dáin Ironfoot added 1 willpower and 1 attack to each Dwarf character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Dwarf."]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/willpower", 1],
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/attack", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "Dáin Ironfoot removed 1 willpower and 1 attack from each Dwarf character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["OR", ["IN_STRING", "$CARD.currentFace.traits", "Dwarf."], ["EQUAL", "$CARD_ID", "$THIS_ID"]]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/willpower", 1],
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/attack", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "347fa1ce-ec8d-43d9-a407-bc26d041b45e": {
                "_comment": "Leadership Dain Ironfoot",
                "inheritFrom": "51223bd0-ffd1-11df-a976-0801206c9005"
            },
            "4823aae3-46ef-4a75-89f9-cbd3aa1b9008": {
                "_comment": "Boromir (Hero, Leadership)",
                "rules": {
                    "boromirEnterPlayTokens": {
                        "_comment": "Add tokens to Gondor allies that enter play if Boromir is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND",
                            "$THIS.inPlay",
                            "$TARGET.inPlay",
                            ["PREV", ["NOT", "$TARGET.inPlay"]],
                            ["IN_STRING", "$TARGET.currentFace.traits", "Gondor."],
                            ["EQUAL", "$TARGET.currentFace.type", "Ally"],
                            ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"],
                            ["GREATER_THAN", "$THIS.tokens.resource", 0]
                        ],
                        "then": [
                            ["LOG", "└── ", "Boromir added 1 attack to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/attack", 1]
                        ]
                    },
                    "boromirPassiveTokens": { 
                        "_comment": "Add/remove tokens on Gondor allies depending on whether Boromir has a resource or not.",
                        "type": "whileInPlay", 
                        "side": "A",
                        "listenTo": ["/cardById/$THIS_ID/tokens/resource"],
                        "condition": ["GREATER_THAN", "$THIS.tokens.resource", 0],
                        "onDo": [
                            ["LOG", "└── ", "Added 1 attack to each Gondor ally in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Gondor."], ["EQUAL", "$CARD.currentFace.type", "Ally"]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/attack", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "Removed 1 attack from each Gondor ally in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Gondor."], ["EQUAL", "$CARD.currentFace.type", "Ally"]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/attack", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "55a2193b-c458-4aa0-82ec-544a373a1dca": {
                "_comment": "Boromir (Hero, Leadership)",
                "inheritFrom": "4823aae3-46ef-4a75-89f9-cbd3aa1b9008"
            },
            "2f0a3f18-c84f-4458-b6f7-2e6be9acee6b": {
                "_comment": "Visionary Leadership",
                "rules": {
                    "visionaryLeadershipEnterPlayTokens": {
                        "_comment": "Add tokens to Gondor characters that enter play if Visionary Leadership is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND",
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            "$THIS.inPlay",
                            "$TARGET.inPlay",
                            ["PREV", ["NOT", "$TARGET.inPlay"]],
                            ["IN_STRING", "$TARGET.currentFace.traits", "Gondor."],
                            ["IS_CHARACTER", "$TARGET"],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resource", 0]
                        ],
                        "then": [
                            ["LOG", "└── ", "Visionary Leadership added 1 willpower to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/willpower", 1]
                        ]
                    },
                    "visionaryLeadershipPassiveTokens": { 
                        "_comment": "Add/remove tokens on Gondor characters depending on whether Visionary Leadership has a resource or not.",
                        "type": "whileInPlay", 
                        "side": "A",
                        "listenTo": ["/cardById/{{$THIS.parentCardId}}/tokens/resource", "/cardById/$THIS_ID/cardIndex"],
                        "condition": ["AND",
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resource", 0]
                        ],
                        "onDo": [
                            ["LOG", "└── ", "Added 1 willpower to each Gondor character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Gondor."], ["IS_CHARACTER", "$CARD"]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/willpower", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "Removed 1 willpower from each Gondor character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Gondor."], ["IS_CHARACTER", "$CARD"]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/willpower", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "c74f3029-f234-482e-b621-173686013e3e": {
                "_comment": "Visionary Leadership",
                "inheritFrom": "2f0a3f18-c84f-4458-b6f7-2e6be9acee6b"
            },
            "09ebd71c-8286-4838-b661-36a8633c9f0c": {
                "_comment": "Aragorn (Hero, Tactics)",
                "rules": {
                    "aragornTargetChangeTokens": {
                        "_comment": "Add/remove tokens on enemies that enter/exit play or change engagement.",
                        "type": "whileInPlay",
                        "listenTo": ["/cardById/*/inPlay", "/cardById/*/groupId"],
                        "condition": ["AND",
                            "$TARGET.inPlay",
                            ["EQUAL", "$TARGET.groupId", "{{$THIS.controller}}Engaged"],
                            ["EQUAL", "$TARGET.currentFace.type", "Enemy"]
                        ],
                        "onDo": ["COND",
                            "$THIS.inPlay",
                            [
                                ["LOG", "└── ", "Aragorn removed 1 defense from ", "$TARGET.currentFace.name", "."],
                                ["DECREASE_VAL", "/cardById/$TARGET_ID/tokens/defense", 1]
                            ]
                        ],
                        "offDo": ["COND",
                            ["AND", "$TARGET.inPlay", "$THIS.inPlay"],
                            [
                                ["LOG", "└── ", "Aragorn added 1 defense to ", "$TARGET.currentFace.name", "."],
                                ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/defense", 1]
                            ]
                        ]
                    },
                    "aragornPassiveTokens": { 
                        "_comment": "Add/remove tokens on enemies when Aragorn enters/leaves play.",
                        "type": "passive", 
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "└── ", "Removed 1 defense from each enemy engaged with {{$ALIAS}}."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["EQUAL", "$CARD.groupId", "{{$THIS.controller}}Engaged"], ["EQUAL", "$CARD.currentFace.type", "Enemy"]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/defense", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "└── ", "Added 1 defense to each enemy engaged with {{$ALIAS}}."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["EQUAL", "$CARD.groupId", "{{$THIS.controller}}Engaged"], ["EQUAL", "$CARD.currentFace.type", "Enemy"]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/defense", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "052b1f85-8b9c-4bb0-a735-bdbd5ac1b2c4": {
                "_comment": "Merry",
                "rules": {
                    "merryOtherHobbitEnterLeavePlayTokens": {
                        "_comment": "Add/remove attack tokens to Merry when other Hobbit heroes enter/leave the owner's control.",
                        "type": "whileInPlay", 
                        "side": "A",
                        "listenTo": ["/cardById/*/inPlay", "/cardById/*/controller"],
                        "condition": [
                            "AND", 
                                "$TARGET.inPlay",
                                ["EQUAL", "$TARGET.controller", "$THIS.controller"]
                        ],
                        "onDo": ["COND",
                            ["AND",
                                ["IN_STRING", "$TARGET.currentFace.traits", "Hobbit."],
                                ["EQUAL", "$TARGET.currentFace.type", "Hero"],
                                ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]
                            ],
                            [
                                ["LOG", "└── ", "Added 1 attack to Merry."],
                                ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/attack", 1]
                            ]
                        ],
                        "offDo": ["COND",
                            ["AND",
                                ["IN_STRING", "$TARGET.currentFace.traits", "Hobbit."],
                                ["EQUAL", "$TARGET.currentFace.type", "Hero"],
                                ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]
                            ],
                            [
                                ["LOG", "└── ", "Removed 1 attack from Merry."],
                                ["DECREASE_VAL", "/cardById/$THIS_ID/tokens/attack", 1]
                            ]
                        ]
                    },
                    "merryEnterLeavePlayTokens": {
                        "_comment": "Add attack to Merry when Merry enters play.",
                        "type": "passive",
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["VAR", "$NUM_HOBBITS",
                                ["LENGTH",
                                    ["FILTER_CARDS", "$CARD", [
                                        "AND",
                                            "$CARD.inPlay",
                                            ["EQUAL", "$CARD.controller", "$THIS.controller"],
                                            ["IN_STRING", "$CARD.currentFace.traits", "Hobbit."],
                                            ["EQUAL", "$CARD.currentFace.type", "Hero"]
                                        ]
                                    ]
                                ]
                            ],
                            ["LOG", "└── ", "$THIS.controller", " added {{$NUM_HOBBITS}} attack to Merry."],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/attack", "$NUM_HOBBITS"]
                        ],
                        "offDo": [
                            ["COND",
                                ["EQUAL", "$THIS.currentSide", "B"],
                                [
                                    ["VAR", "$NUM_HOBBITS",
                                        ["LENGTH",
                                            ["PREV", ["FILTER_CARDS", "$CARD", [
                                                        "AND",
                                                            "$CARD.inPlay",
                                                            ["EQUAL", "$CARD.controller", "$THIS.controller"],
                                                            ["IN_STRING", "$CARD.currentFace.traits", "Hobbit."],
                                                            ["EQUAL", "$CARD.currentFace.type", "Hero"]
                                                        ]
                                                    ]
                                            ]
                                        ]
                                    ],
                                    ["LOG", "└── ", "$THIS.controller", " removed {{$NUM_HOBBITS}} attack to Merry."],
                                    ["DECREASE_VAL", "/cardById/$THIS_ID/tokens/attack", "$NUM_HOBBITS"]
                                ]
                            ]
                        ]
                    }
                }
            },
            "1c149f93-9e3b-42fa-878c-80b29563a283": {
                "_comment": "Ethir Swordsman",
                "rules": {
                    "ethirSwordsmanEnterPlayTokens": {
                        "_comment": "Add tokens to allies that enter play if this ally is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$THIS.currentSide", "A"], "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Outlands."], ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]],
                        "then": [
                            ["LOG", "└── ", "$TARGET.controller", " added 1 willpower to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/willpower", 1]
                        ]
                    },
                    "ethirSwordsmanPassiveTokens": {
                        "_comment": "Add/remove tokens depending on whether this is in play.",
                        "type": "passive", 
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["LOG", "└── ", "$THIS.controller", " added 1 willpower to each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/willpower", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "$THIS.controller", " removed 1 willpower from each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["OR", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."], ["EQUAL", "$CARD_ID", "$THIS_ID"]]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/willpower", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "2e84d805-365c-47ea-9c4f-e3f75daeb9a6": {
                "_comment": "Warrior of Lossarnach",
                "rules": {
                    "warriorOfLossarnachEnterPlayTokens": {
                        "_comment": "Add tokens to allies that enter play if this ally is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$THIS.currentSide", "A"], "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Outlands."], ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]],
                        "then": [
                            ["LOG", "└── ", "$TARGET.controller", " added 1 defense to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/defense", 1]
                        ]
                    },
                    "warriorOfLossarnachPassiveTokens": { 
                        "_comment": "Add/remove tokens depending on whether this is in play.",
                        "type": "passive", 
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["LOG", "└── ", "$THIS.controller", " added 1 defense to each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/defense", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "$THIS.controller", " removed 1 defense from each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["OR", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."], ["EQUAL", "$CARD_ID", "$THIS_ID"]]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/defense", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "c00844d6-1c3c-4e8c-a46c-8de15b8408df": {
                "_comment": "Knights of the Swan",
                "rules": {
                    "knightsOfTheSwanEnterPlayTokens": {
                        "_comment": "Add tokens to allies that enter play if this ally is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$THIS.currentSide", "A"], "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Outlands."], ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]],
                        "then": [
                            ["LOG", "└── ", "$TARGET.controller", " added 1 attack to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/attack", 1]
                        ]
                    },
                    "knightsOfTheSwanPassiveTokens": {
                        "_comment": "Add/remove tokens depending on whether this is in play.",
                        "type": "passive", 
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["LOG", "└── ", "$THIS.controller", " added 1 attack to each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/attack", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["OR", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."], ["EQUAL", "$CARD_ID", "$THIS_ID"]]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/attack", 1]
                                ]
                            ]]],
                            ["LOG", "└── ", "$THIS.controller", " removed 1 attack from each Outlands character in play."]
                        ]
                    }
                }
            },
            "4cb4741d-c9d8-4d62-ab4f-50fa80c59fbb": {
                "_comment": "Anfalas Herdsman",
                "rules": {
                    "anfalasHerdsmanEnterPlayTokens": {
                        "_comment": "Add tokens to allies that enter play if this ally is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$THIS.currentSide", "A"], "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Outlands."], ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]],
                        "then": [
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/hitPoints", 1],
                            ["LOG", "└── ", "$TARGET.controller", " added 1 hit point to ", "$TARGET.currentFace.name", "."]
                        ]
                    },
                    "anfalasHerdsmanPassiveTokens": {
                        "_comment": "Add/remove tokens depending on whether this is in play.",
                        "type": "passive", 
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["LOG", "└── ", "$THIS.controller", " added 1 hit point to each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/hitPoints", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "$THIS.controller", " removed 1 hit point from each Outlands character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["OR", ["IN_STRING", "$CARD.currentFace.traits", "Outlands."], ["EQUAL", "$CARD_ID", "$THIS_ID"]]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/hitPoints", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "1f7fc118-94a7-48a0-bd0c-9c15a36ddc23": {
                "_comment": "Bill the Pony",
                "rules": {
                    "billEnterPlayTokens": {
                        "_comment": "Add tokens to allies that enter play if this ally is in play.",
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$THIS.currentSide", "A"], "$TARGET.inPlay", ["PREV", ["NOT", "$TARGET.inPlay"]], ["IN_STRING", "$TARGET.currentFace.traits", "Hobbit."], ["NOT_EQUAL", "$THIS_ID", "$TARGET_ID"]],
                        "then": [
                            ["LOG", "└── ", "$TARGET.controller", " added 1 hit point to ", "$TARGET.currentFace.name", "."],
                            ["INCREASE_VAL", "/cardById/$TARGET_ID/tokens/hitPoints", 1]
                        ]
                    },
                    "billPassiveTokens": {
                        "_comment": "Add/remove tokens depending on whether this is in play.",
                        "type": "passive", 
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide"],
                        "condition": [
                            "AND", 
                                "$THIS.inPlay",
                                ["EQUAL", "$THIS.currentSide", "A"]
                        ],
                        "onDo": [
                            ["LOG", "└── ", "$THIS.controller", " added 1 hit point to each Hobbit character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Hobbit."]],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/hitPoints", 1]
                                ]
                            ]]]
                        ],
                        "offDo": [
                            ["LOG", "└── ", "$THIS.controller", " removed 1 hit point from each Hobbit character in play."],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                            ["COND",
                                ["AND", "$CARD.inPlay", ["OR", ["IN_STRING", "$CARD.currentFace.traits", "Hobbit."], ["EQUAL", "$CARD_ID", "$THIS_ID"]]],
                                [
                                    ["DECREASE_VAL", "/cardById/$CARD_ID/tokens/hitPoints", 1]
                                ]
                            ]]]
                        ]
                    }
                }
            },
            "2b28d8ba-23b9-4f48-9808-3bbe2ed0a8fc": {
                "_comment": "Dwarf Pipe",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            ["GREATER_THAN", ["LENGTH", "$GAME.groupById.{{$THIS.controller}}Discard.stackIds"], 0]
                        ],
                        [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["VAR", "$TOP_CARD_ID", ["GET_CARD_ID", "{{$THIS.controller}}Discard", 0, 0]],
                            ["LOG", "└── ", "Dwarf pipe moved ", "$GAME.cardById.{{$TOP_CARD_ID}}.currentFace.name"," from {{$ALIAS}}'s discard to bottom of deck."],
                            ["MOVE_CARD", "$TOP_CARD_ID", "{{$THIS.controller}}Deck", -1],
                            ["TOGGLE_EXHAUST", "$THIS"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "86e1977f-0a24-46c8-a7ee-d5d78410f1a3": {
                "_comment": "Dwarf Pipe",
                "inheritFrom": "2b28d8ba-23b9-4f48-9808-3bbe2ed0a8fc"
            },
            "41b56fc4-6ecd-4c9a-80d4-3074c267e823": {
                "_comment": "Silver Harp",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            ["GREATER_THAN", ["LENGTH", "$GAME.groupById.{{$PLAYER_N}}Discard.stackIds"], 0]
                        ],
                        [
                            ["LOG", "└── ", "Returned top card of discard pile to hand."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["VAR", "$TOP_CARD_ID", ["GET_CARD_ID", "{{$PLAYER_N}}Discard", 0, 0]],
                            ["MOVE_CARD", "$TOP_CARD_ID", "{{$PLAYER_N}}Hand", -1]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801213c9027": {
                "_comment": "Vilya",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            ["NOT", "$GAME.cardById.{{$THIS.parentCardId}}.exhausted"],
                            ["GREATER_THAN", ["LENGTH", "$GAME.groupById.{{$THIS.controller}}Deck.stackIds"], 0]
                        ],
                        [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["VAR", "$TOP_CARD_ID", ["GET_CARD_ID", "{{$THIS.controller}}Deck", 0, 0]],
                            ["MOVE_CARD", "$TOP_CARD_ID", "{{$THIS.controller}}Play1", -1],
                            ["LOG", "└── ", "Vilya moved ", "$GAME.cardById.{{$TOP_CARD_ID}}.currentFace.name"," from {{$ALIAS}}'s deck into play area."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["TOGGLE_EXHAUST", "$GAME.cardById.{{$THIS.parentCardId}}"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "65608b5c-4420-4d76-a458-71a8b32e4159": {
                "_comment": "Vilya",
                "inheritFrom": "51223bd0-ffd1-11df-a976-0801213c9027"
            },
            "51223bd0-ffd1-11df-a976-1801204c9032": {
                "_comment": "Fili",
                "ability": {
                    "A": [
                        ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                        ["VAR", "$VALID_TARGET",
                            ["ONE_CARD",
                            "$CARD",
                            ["AND",
                                ["EQUAL", "$CARD.sides.A.name", "Kili"],
                                ["EQUAL", "$CARD.groupId", "{{$THIS.controller}}Deck"]
                            ]
                            ]
                        ],
                        ["COND",
                            ["DEFINED", "$VALID_TARGET"],
                            [
                                ["LOG", "└── ", "Fili put Kili into play from {{$ALIAS}}'s deck."],
                                ["MOVE_CARD", "$VALID_TARGET.id", "{{$THIS.controller}}Play1", -1],
                                ["SHUFFLE_GROUP", "{{$THIS.controller}}Deck"]
                            ],
                            true,
                            ["LOG", "└── ", "Kili not found in {{$ALIAS}}'s deck."]
                        ]
                    ]
                }
            },
            "1f04497c-34ee-4d6b-a765-65103bc1ddd4": {"_comment": "Fili", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9032"},
            "418da080-4747-46c1-b73e-a327c5ce626f": {"_comment": "Fili", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9032"},
            "51223bd0-ffd1-11df-a976-1801204c9055": {
                "_comment": "Kili",
                "ability": {
                    "A": [
                        ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                        ["VAR", "$VALID_TARGET",
                            ["ONE_CARD",
                            "$CARD",
                            ["AND",
                                ["EQUAL", "$CARD.sides.A.name", "Fili"],
                                ["EQUAL", "$CARD.groupId", "{{$THIS.controller}}Deck"]
                            ]
                            ]
                        ],
                        ["COND",
                            ["DEFINED", "$VALID_TARGET"],
                            [
                                ["LOG", "└── ", "Kili put Fili into play from {{$ALIAS}}'s deck."],
                                ["MOVE_CARD", "$VALID_TARGET.id", "{{$THIS.controller}}Play1", -1],
                                ["SHUFFLE_GROUP", "{{$THIS.controller}}Deck"]
                            ],
                            true,
                            ["LOG", "└── ", "Fili not found in {{$ALIAS}}'s deck."]
                        ]
                    ]
                }
            },
            "168eb130-262e-4287-a70f-ad34397c1626": {"_comment": "Kili", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9055"},
            "65156eb7-dc07-43b9-9290-07ba4063564b": {"_comment": "Kili", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9055"},
            "f4d94f3d-d3af-44d6-9896-764484302bb1": {
                "_comment": "Double Back (Side Quest)",
                "ability": {
                    "A": [
                        ["LOG", "$ALIAS_N", " reduced each player's threat by 5 and added ", "$ACTIVE_FACE.name", " to the victory display."],
                        ["MOVE_CARD", "$ACTIVE_CARD_ID", "sharedVictory", 0],
                        ["FOR_EACH_VAL", "$PLAYER_I", "$PLAYER_ORDER", [
                            ["DECREASE_VAL", "/playerData/$PLAYER_I/threat", 5]
                        ]]                  
                    ]
                }
            },
            "b9e3d591-5973-4f35-90b8-d74d0aeabcc7": {
                "_comment": "Legacy of Numenor",
                "ability": {
                    "A": [
                        ["DOOMED", 4],
                        ["LOG", "└── ", "Added a resource to each hero's resource pool."],
                        ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$CARD_BY_ID", [
                            ["COND",
                                ["AND",
                                    ["EQUAL", "$CARD.inPlay", true],
                                    ["EQUAL", "$CARD.currentFace.type", "Hero"]
                                ],
                                [
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/resource", 1]
                                ]
                            ]
                        ]],
                        ["ACTION_LIST", "discardCard"]
                    ]
                }
            },
            "79cb32f4-053c-47e1-983d-59d64b493a76": {
                "_comment": "Waters of Nimrodel",
                "ability": {
                    "A": [
                        ["DOOMED", 3],
                        ["LOG", "└── ", "Healing all damage on each character in play."],
                        ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$CARD_BY_ID", [
                            ["COND",
                                ["AND",
                                    ["EQUAL", "$CARD.inPlay", true],
                                    ["OR", ["EQUAL", "$CARD.currentFace.type", "Hero"], ["EQUAL", "$CARD.currentFace.type", "Ally"]]
                                ],
                                [
                                    ["SET", "/cardById/$CARD_ID/tokens/damage", 0]
                                ]
                            ]
                        ]],
                        ["ACTION_LIST", "discardCard"]
                    ]
                }
            },
            "cfba1adb-5d73-4d46-b10b-b3af003f0e90": {
                "_comment": "Deep Knowledge",
                "ability": {
                    "A": [
                        ["DOOMED", 2],
                        ["LOG", "└── ", "Each player draws 2 cards."],
                        ["FOR_EACH_VAL", "$PLAYER_I", "$PLAYER_ORDER", [
                            ["DRAW_CARD", 2, "$PLAYER_I"]
                        ]],
                        ["ACTION_LIST", "discardCard"]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801201c9003": {
                "_comment": "Campfire Tales",
                "ability": {
                    "A": [
                        ["LOG", "└── ", "Each player draws a card."],
                        ["FOR_EACH_VAL", "$PLAYER_I", "$PLAYER_ORDER", [
                            ["DRAW_CARD", 1, "$PLAYER_I"]
                        ]],
                        ["ACTION_LIST", "discardCard"]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801212c9010": {
                "_comment": "Daeron's Runes",
                "ability": {
                    "A": [
                        ["DRAW_CARD", 2, "$THIS.controller"],
                        ["LOG", "└── ", "{{$ALIAS_N}} drew 2 cards and must now discard a card from their hand."],
                        ["ACTION_LIST", "discardCard"]
                    ]
                }
            },
            "d8729719-5d37-48c2-9bf6-8d2c8d579901": {"_comment": "Daeron's Runes", "inheritFrom": "51223bd0-ffd1-11df-a976-0801212c9010"},
            "37863571-be66-46b1-82d3-d21f4f0e653c": {"_comment": "Daeron's Runes", "inheritFrom": "51223bd0-ffd1-11df-a976-0801212c9010"},
            "8d6a15a8-e363-46bb-8e49-0af45a1ea0d1": {
                "_comment": "Galadriel (Hero)",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["COND",
                                ["GREATER_THAN", "$GAME.numPlayers", 1],
                                [
                                    ["PROMPT", "$PLAYER_N", "executeForTargetPlayer"],
                                    ["FOR_EACH_START_STOP_STEP", "$I", 1, ["ADD", "$GAME.numPlayers", 1], 1, [
                                        ["PROMPT_ADD_OPTION", "$PLAYER_N", ["GET_ALIAS", "player{{$I}}"], "{{$I}}", 
                                            ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                                ["LOG", "└── ", ["GET_ALIAS", "player{I}"], " reduces threat by 1 and draws a card."],
                                                ["DRAW_CARD", 1, "player{I}"],
                                                ["DECREASE_VAL", "/playerData/player{I}/threat", 1]
                                            ]], "{I}", "{{$I}}"]
                                        ]
                                    ]]
                                ],
                                ["TRUE"],
                                [
                                    ["LOG", "└── ", ["GET_ALIAS", "player1"], " reduces threat by 1 and draws a card"],
                                    ["DRAW_CARD", 1],
                                    ["DECREASE_VAL", "/playerData/player1/threat", 1]
                                ]
                            ]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "8ccfbcf2-676c-4e24-ab5e-fa479343ab39": {"_comment": "Galadriel (Hero)", "inheritFrom": "8d6a15a8-e363-46bb-8e49-0af45a1ea0d1"},
            "ff3794e8-d8b1-48dc-a9f8-97ea7d6b3874": {
                "_comment": "Galadriel's Handmaiden",
                "ability": {
                    "A": ["COND",
                            ["GREATER_THAN", "$GAME.numPlayers", 1],
                            [
                                ["PROMPT", "$PLAYER_N", "executeForTargetPlayer"],
                                ["FOR_EACH_START_STOP_STEP", "$I", 1, ["ADD", "$GAME.numPlayers", 1], 1, [
                                    ["PROMPT_ADD_OPTION", "$PLAYER_N", ["GET_ALIAS", "player{{$I}}"], "{{$I}}", 
                                        ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                            ["LOG", "└── ", ["GET_ALIAS", "player{I}"], " reduces threat by 1."],
                                            ["DECREASE_VAL", "/playerData/player{I}/threat", 1]
                                        ]], "{I}", "{{$I}}"]
                                    ]
                                ]]
                            ],
                            ["TRUE"],
                            [
                                ["LOG", "└── ", ["GET_ALIAS", "player1"], " reduces threat by 1"],
                                ["DECREASE_VAL", "/playerData/player1/threat", 1]
                            ]
                    ]
                }
            },
            "8a95a914-ab86-41db-a87e-553e50b30248": {"_comment": "Galadriel's Handmaiden", "inheritFrom": "ff3794e8-d8b1-48dc-a9f8-97ea7d6b3874"},
            "51223bd0-ffd1-11df-a976-0801200c9012": {
                "_comment": "Beravor",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["COND",
                                ["GREATER_THAN", "$GAME.numPlayers", 1],
                                [
                                    ["PROMPT", "$PLAYER_N", "executeForTargetPlayer"],
                                    ["FOR_EACH_START_STOP_STEP", "$I", 1, ["ADD", "$GAME.numPlayers", 1], 1, [
                                        ["PROMPT_ADD_OPTION", "$PLAYER_N", ["GET_ALIAS", "player{{$I}}"], "{{$I}}", 
                                            ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                                ["LOG", "└── ", ["GET_ALIAS", "player{I}"], " draws 2 cards."],
                                                ["DRAW_CARD", 2, "player{I}"]
                                            ]], "{I}", "{{$I}}"]
                                        ]
                                    ]]
                                ],
                                ["TRUE"],
                                [
                                    ["LOG", "└── ", ["GET_ALIAS", "player1"], " draws 2 cards"],
                                    ["DRAW_CARD", 2]
                                ]
                            ]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801200c9062": {
                "_comment": "Gleowine",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["COND",
                                ["GREATER_THAN", "$GAME.numPlayers", 1],
                                [
                                    ["PROMPT", "$PLAYER_N", "executeForTargetPlayer"],
                                    ["FOR_EACH_START_STOP_STEP", "$I", 1, ["ADD", "$GAME.numPlayers", 1], 1, [
                                        ["PROMPT_ADD_OPTION", "$PLAYER_N", ["GET_ALIAS", "player{{$I}}"], "{{$I}}", 
                                            ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                                ["LOG", "└── ", ["GET_ALIAS", "player{I}"], " draws a card."],
                                                ["DRAW_CARD", 1, "player{I}"]
                                            ]], "{I}", "{{$I}}"]
                                        ]
                                    ]]
                                ],
                                ["TRUE"],
                                [
                                    ["LOG", "└── ", ["GET_ALIAS", "player1"], " draws a card."],
                                    ["DRAW_CARD", 1]
                                ]
                            ]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801200c9046": {
                "_comment": "The Galadhrim's Greeting",
                "ability": {
                    "A": [["COND",
                            ["GREATER_THAN", "$GAME.numPlayers", 1],
                            [
                                ["PROMPT", "$PLAYER_N", "basePrompt", "Choose an option"],
                                ["PROMPT_ADD_OPTION", "$PLAYER_N", "Reduce each player's threat by 2", "E", ["POINTER", [
                                    ["LOG", "└── ", "Reduced each player's threat by 2."],
                                    ["FOR_EACH_VAL", "$PLAYER_I", "$PLAYER_ORDER",
                                        ["DECREASE_VAL", "/playerData/$PLAYER_I/threat", 2]
                                    ]
                                ]]],
                                ["FOR_EACH_START_STOP_STEP", "$I", 1, ["ADD", "$GAME.numPlayers", 1], 1, [
                                    ["PROMPT_ADD_OPTION", "$PLAYER_N", ["FORMAT", "Reduce player {{$I}}'s threat by 6", "player{{$I}}"], "{{$I}}", 
                                        ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                            ["LOG", "└── ", ["GET_ALIAS", "player{I}"], " Reduced their threat by 6."],
                                            ["DECREASE_VAL", "/playerData/player{I}/threat", 6]
                                        ]], "{I}", "{{$I}}"]
                                    ] 
                                ]]
                            ],
                            ["TRUE"],
                            [
                                ["LOG", "└── ", ["GET_ALIAS", "player1"], " reduced their threat by 6."],
                                ["DECREASE_VAL", "/playerData/$PLAYER_N/threat", 6]
                            ]
                        ],
                        ["ACTION_LIST", "discardCard"]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801200c9014": {
                "_comment": "Faramir",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["COND",
                                ["GREATER_THAN", "$GAME.numPlayers", 1],
                                [
                                    ["PROMPT", "$PLAYER_N", "executeForTargetPlayer"],
                                    ["FOR_EACH_START_STOP_STEP", "$I", 1, ["ADD", "$GAME.numPlayers", 1], 1, [
                                        ["PROMPT_ADD_OPTION", "$PLAYER_N", ["GET_ALIAS", "player{{$I}}"], "{{$I}}", 
                                            ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                                ["LOG", "└── ", "Added 1 willpower to each character controlled by ", ["GET_ALIAS", "player{I}"], " until the end of the phase."],
                                                ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                                                    ["COND",
                                                        ["AND", "$CARD.inPlay", ["EQUAL", "$CARD.controller", "player{I}"], ["IS_CHARACTER", "$CARD"]],
                                                        [
                                                            ["ADD_TEMP_TOKEN", "phase", "$CARD_ID", "willpower", 1]
                                                        ]
                                                    ]
                                                ]]
                                            ]], "{I}", "{{$I}}"]
                                        ]  
                                    ]]
                                ],
                                ["TRUE"],
                                [
                                    ["LOG", "└── ", "Added 1 willpower to each character until the end of the phase."],
                                    ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                                        ["COND",
                                            ["AND", "$CARD.inPlay", ["EQUAL", "$CARD.controller", "player1"], ["IS_CHARACTER", "$CARD"]],
                                            [
                                                ["ADD_TEMP_TOKEN", "phase", "$CARD_ID", "willpower", 1]
                                            ]
                                    ]]]
                                ]
                            ]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "05419721-91bd-4851-ac95-cdc079a2c036": {"_comment": "Faramir", "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9014"},
            "47253ed8-2376-495a-a9b2-8f829c66e3bf": {"_comment": "Faramir", "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9014"},
            "51223bd0-ffd1-11df-a976-0801212c9019": {
                "_comment": "Imladris Stargazer",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "51223bd0-ffd1-11df-a976-0801213c9015": {
                "_comment": "Master of the Forge",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "6e97a705-2458-4aa1-ad90-f3cd8200ca5a": {
                "_comment": "Mirror of Galadriel",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_X", "$THIS", 10]
                }
            },
            "a17465f5-e6f5-4699-b0d7-79355286a065": {
                "_comment": "Entmoot",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "bd20ff6a-d77f-47d8-81dd-202e5f21cfaf": {
                "_comment": "Timely Aid",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "51223bd0-ffd1-11df-a976-0801212c9010": {
                "_comment": "Daeron's Runes",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 2]
                }
            },
            "d8729719-5d37-48c2-9bf6-8d2c8d579901": {"_comment": "Daeron's Runes", "inheritFrom": "51223bd0-ffd1-11df-a976-0801212c9010"},
            "37863571-be66-46b1-82d3-d21f4f0e653c": {"_comment": "Daeron's Runes", "inheritFrom": "51223bd0-ffd1-11df-a976-0801212c9010"},
            "51e0054c-c48d-4fc7-9737-30bf12d4b52a": {
                "_comment": "Westfold Horse-breeder",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 10]
                }
            },
            "0567c2df-677c-4529-985a-54621088fe58": {"_comment": "Westfold Horse-breeder", "inheritFrom": "51e0054c-c48d-4fc7-9737-30bf12d4b52a"},
            "51223bd0-ffd1-11df-a976-0801201c9008": {
                "_comment": "The Eagles Are Coming",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "8f1cedc5-bca5-4594-bc01-73caae4a5083": {
                "_comment": "Gwaihir's Debt",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "51223bd0-ffd1-11df-a976-0801204c9005": {
                "_comment": "Gildor Inglorion (Ally)",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_X", "$THIS", 3]
                }
            },
            "08d95282-e88d-4a9c-a01b-651d569052ee": {
                "_comment": "Raise the Shire",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "f39eaad9-134d-406b-9111-e03c33e0cd16": {
                "_comment": "The Tree People",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "cae49f93-1a11-4bef-bed2-8305e91c3c2a": {"_comment": "The Tree People", "inheritFrom": "f39eaad9-134d-406b-9111-e03c33e0cd16"},
            "51223bd0-ffd1-11df-a976-0801201c9004": {
                "_comment": "Mustering the Rohirrm",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 10]
                }
            },
            "8047c8c2-1569-428c-865e-0459c2733db3": {
                "_comment":  "The Muster of Rohan",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 10]
                }
            },
            "52f54faa-5db0-4b11-bd8b-5ee85dec5b97": {
                "_comment":  "An Unexpected Party",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 10]
                }
            },
            "e42cb28b-0f2e-4510-962b-d96f19006be2": {
                "_comment":  "Open the Gates",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "793df72d-dce6-48fe-9d6c-24a2cf289d5f": {
                "_comment":  "Need Brooks no Delay",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_X", "$THIS", 10]
                }
            },
            "439f1d94-3098-4b4a-9ceb-3b28a6eac804": {"_comment": "The Muster of Rohan", "inheritFrom": "8047c8c2-1569-428c-865e-0459c2733db3"},
            "9152834a-5355-42ba-9592-1a3c1940d1a8": {
                "_comment": "King under the Mountain",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_X", "$THIS", 2]
                }
            },
            "2609f225-615b-4dc4-a451-424fdedf685d": {"_comment": "King under the Mountain", "inheritFrom": "9152834a-5355-42ba-9592-1a3c1940d1a8"},
            "51223bd0-ffd1-11df-a976-1801204c9019": {
                "_comment": "Bofur (Tactics)",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_X", "$THIS", 5]
                }
            },
            "ed2a2959-7070-4f23-bb37-d6a0a19217c9": {
                "_comment": "Odo Proudfoot",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "ad26f445-5cba-461c-8226-26a75cdf1891": {
                "_comment": "Spare Pipe",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "b313de3d-897e-4e74-afc5-d31fceaa6162": {
                "_comment": "Weather Hills Watchman",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "27c06f1e-7be0-417e-9029-f5a71c93e3c5": {
                "_comment": "Long Lake Fisherman",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "8cd14645-20ad-4316-94cd-2381e828c68d": {
                "_comment": "Haleth",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "bd81ff6a-9c8f-415e-85fb-da84c21ef2a4": {
                "_comment": "Galadhrim Minstrel",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "c691690d-16ff-4aea-8639-a9655a30216c": {"_comment": "Galadhrim Minstrel", "inheritFrom": "bd81ff6a-9c8f-415e-85fb-da84c21ef2a4"},
            "dceb6fc5-2ba6-4fe1-8c8c-9ab328e16698": {"_comment": "Galadhrim Minstrel", "inheritFrom": "bd81ff6a-9c8f-415e-85fb-da84c21ef2a4"},
            "5177774a-29a0-4ce7-890c-aae2fe01e611": {
                "_comment": "Soldier of Gondor",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                }
            },
            "cee41b55-e58d-4e05-a372-cdcdc31e0212": {"_comment": "Soldier of Gondor", "inheritFrom": "5177774a-29a0-4ce7-890c-aae2fe01e611"},
            "b82b6804-22c6-4e54-b029-50e99962cbe4": {
                "_comment": "Open the Armory",
                "ability": {
                    "A": ["COND",
                        ["IS_PLAYER_IN_VALOUR", "$THIS.controller"],
                        ["DISCARD_TO_LOOK_AT_X", "$THIS", 5],
                        ["TRUE"],
                        ["DISCARD_TO_LOOK_AT_X", "$THIS", 10]
                    ]
                }
            },
            "9de50e07-a3a3-4049-908c-c0463aabf91f": {
                "_comment": "The Seeing-stone",
                "ability": {
                     "A": [
                        ["DOOMED", 1],
                        ["DISCARD_TO_LOOK_AT_X", "$THIS", -1]
                     ]
                 }
            },
            "ad0cbc82-6807-4a5a-ada8-97952cb02c5f": {
                "_comment": "Send for Aid (Side Quest)",
                "ability": {
                    "A": [
                        ["LOG", "$ALIAS_N", " added ", "$ACTIVE_FACE.name", " to the victory display."],
                        ["MOVE_CARD", "$ACTIVE_CARD_ID", "sharedVictory", 0],
                        ["FOR_EACH_VAL", "$PLAYER_I", "$PLAYER_ORDER", [
                            ["VAR", "$PLAYER_I_ALIAS", ["GET_ALIAS", "$PLAYER_I"]],
                            ["LOG", "└── ", "{{$PLAYER_I_ALIAS}} is looking at the top 10 cards of their deck."],
                            ["LOOK_AT", "$PLAYER_I", "{{$PLAYER_I}}Deck", 10, true]
                        ]]                  
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801200c9060": {
                "_comment": "Henamarth Riversong",
                "ability": {
                     "A": ["EXHAUST_TO_LOOK_AT_ENCOUNTER_X", "$THIS", 1]
                 }
            },
            "12951d4e-ad35-4103-8cb5-964cb1f7bfd2": {"_comment": "Henamarth Riversong", "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9060"},
            "e7ee6a7e-d0bb-4a6d-8999-3c3e51032ca5": {"_comment": "Henamarth Riversong", "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9060"},
            "51223bd0-ffd1-11df-a976-0801200c9010": {
                "_comment": "Denethor (Hero, Lore)",
                "ability": {
                    "A": ["EXHAUST_TO_LOOK_AT_ENCOUNTER_X", "$THIS", 1]
                }
            },
            "51223bd0-ffd1-11df-a976-0801213c9022": {
                "_comment": "Risk Some Light",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_ENCOUNTER_X", "$THIS", 3]
                }
            },
            "51223bd0-ffd1-11df-a976-0801206c9017": {
                "_comment": "Rumour from the Earth",
                "ability": {
                    "A": ["DISCARD_TO_LOOK_AT_ENCOUNTER_X", "$THIS", 1]
                }
            },
            "b546c9b7-7721-4275-ba8b-ba28364aeb95": {
                "_comment": "Firyal",
                "ability": {
                    "A": ["LOOK_AT_X", "sharedEncounterDeck", 1]
                }
            },
            "51223bd0-ffd1-11df-a976-0801212c9021": {
                "_comment": "Longbeard Elder",
                "ability": {
                    "A": ["LOOK_AT_X", "sharedEncounterDeck", 1]
                }
            },
            "c7ff3577-8145-4bef-a5e6-4ec8a503025f": {"_comment": "Longbeard Elder", "inheritFrom": "51223bd0-ffd1-11df-a976-0801212c9021"},
            "86edf661-e3d8-4372-9325-f2d2d5ac354a": {
                "_comment": "Ithilien Lookout",
                "ability": {
                    "A": ["LOOK_AT_X", "sharedEncounterDeck", 1]
                }
            },
            "c541b65a-d6d4-4b2c-8925-96c31d52aa1c": {
                "_comment": "Celduin Traveler",
                "ability": {
                    "A": ["LOOK_AT_X", "sharedEncounterDeck", 1]
                }
            },
            "347cfbbb-69a7-4f43-84b2-2a8751be552f": {
                "_comment": "Far-sighted",
                "ability": {
                     "A": [
                        ["DOOMED", 1],
                        ["DISCARD_TO_LOOK_AT_ENCOUNTER_X", "$THIS", 5]
                     ]
                 }
            },
            "f8a3acfb-3b0d-414b-b5d0-2612d33c193d": {
                "_comment": "Scout Ahead (Side Quest)",
                "ability": {
                    "A": [
                        ["VAR", "$NUM_CARDS",  ["ADD", "$GAME.numPlayers", 4]],
                        ["LOG", "$ALIAS_N", " added ", "$ACTIVE_FACE.name", " to the victory display."],
                        ["MOVE_CARD", "$ACTIVE_CARD_ID", "sharedVictory", 0],
                        ["LOOK_AT_X", "sharedEncounterDeck", "$NUM_CARDS"]
                    ]
                }
            },
            "3d09a998-9ad0-4b98-9c42-50c4226cc73b": {
                "_comment": "Galadriel (Ally)",
                "ability": {
                    "A": ["LOOK_AT_X", "{{$THIS.controller}}Deck", 5]
                },
                "rules": {
                    "galadrielDiscard": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true]
                        ],
                        "then": [
                            ["DEFINE", "$ACTIVE_CARD_ID", "$THIS_ID"],
                            ["ACTION_LIST", "discardCard"]
                        ]
                    }
                }
            },
            "b20bd2b6-c4b8-464d-81ed-c1285c99ae7e": {"_comment": "Galadriel (Ally)", "inheritFrom": "3d09a998-9ad0-4b98-9c42-50c4226cc73b"},
            "66cf39b5-015f-4bae-b304-4a61b5d1bedf": {
                "_comment": "Prince Imrahil (Tactics Hero)",
                "ability": {
                    "A": ["ACTION_LIST_TO_LOOK_AT_X", 
                        ["AND", "$THIS.inPlay", ["GREATER_THAN", "$THIS.tokens.resource", 0]],
                        ["LIST", "DECREASE_VAL", "/cardById/$THIS_ID/tokens/resource", 1],
                        "$THIS",
                        "deck",
                        5
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-1801204c9065": {
                "_comment": "Ori",
                "rules": {
                    "drawAdditionalCard": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true],
                            ["HAS_5_OR_MORE_DWARVES", "$THIS.controller"]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "├── ", "{{$ALIAS}} draws 1 additional card from Ori."],
                            ["DRAW_CARD", 1, "$THIS.controller"]
                        ]
                    }
                }
            },
            "3f1fe728-ecc6-4aff-a056-31e3731e39c2": {"_comment": "Ori", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9065"},
            "d45259f1-a551-466c-8352-cc466e1670c2": {
                "_comment": "Stone of Elostirion",
                "rules": {
                    "drawAdditionalCard": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true],
                            ["GREATER_THAN", "$THIS.cardIndex", 0]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "├── ", "{{$ALIAS}} draws 1 additional card from Stone of Elostirion."],
                            ["DRAW_CARD", 1, "$THIS.controller"]
                        ]
                    }
                }
            },
            "51223bd0-ffd1-11df-a976-0801201c9001": {
                "_comment": "Bilbo Baggins (Hero, Lore)",
                "rules": {
                    "drawAdditionalCard": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$GAME.firstPlayer"]],
                            ["LOG", "├── ", "{{$ALIAS}} draws 1 additional card from Bilbo Baggins."],
                            ["DRAW_CARD", 1, "$GAME.firstPlayer"]
                        ]
                    }
                }
            },
            "8ad1cefa-21c5-435c-8865-6417de0e5ba6": {
                "_comment": "Prepare for Battle (Side Quest)",
                "rules": {
                    "drawAdditionalCard": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.groupId", "sharedVictory"]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$GAME.firstPlayer"]],
                            ["LOG", "├── ", "{{$ALIAS}} draws 1 additional card from Prepare for Battle."],
                            ["DRAW_CARD", 1, "$GAME.firstPlayer"]
                        ]
                    }
                }
            },
            "c266126d-cf2d-4a61-aac7-28bac2d1ea0d": {
                "_comment": "Treebeard",
                "rules": {
                    "treebeardResource": {
                        "type": "trigger",
                        "autoRun": {
                            "status": "prompt",
                            "promptPlayerI": "$THIS.controller",
                            "promptMessage": "Add 1 resource to Treebeard?"
                        },
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "├── ", "Treebeard gains 1 resource."],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/resource", 1]
                        ]
                    }
                }
            },
            "51223bd0-ffd1-11df-a976-0801203c9003": {
                "_comment": "Radagast (Ally)",
                "rules": {
                    "radagastResource": {
                        "type": "trigger",
                        "autoRun": {
                            "status": "prompt",
                            "promptPlayerI": "$THIS.controller",
                            "promptMessage": "Add 1 resource to Radagast?"
                        },
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "{{$ALIAS}} added 1 resource to Radagast."],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/resource", 1]
                        ]
                    }
                }
            },
            "51223bd0-ffd1-11df-a976-0801203c9003": {
                "_comment": "Radagast (Ally)",
                "rules": {
                    "radagastResource": {
                        "type": "trigger",
                        "autoRun": {
                            "status": "prompt",
                            "promptPlayerI": "$THIS.controller",
                            "promptMessage": "Add 1 resource to Radagast?"
                        },
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "{{$ALIAS}} added 1 resource to Radagast."],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/resource", 1]
                        ]
                    }
                }
            },
            "51223bd0-ffd1-11df-a976-1801204c9083": {
                "_comment": "Thorin Oakenshield",
                "rules": {
                    "thorinResource": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true],
                            ["HAS_5_OR_MORE_DWARVES", "$THIS.controller"]
                        ],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "├── ", "Thorin Oakenshield gains 1 additional resource."],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/resource", 1]
                        ]
                    }
                }
            },
            "attachedHeroGainsOneResourceInResourcePhase": {
                "abstract": true,
                "rules": {
                    "collectAdditionalResource": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true],
                            ["GREATER_THAN", "$THIS.cardIndex", 0]
                        ],
                        "then": [
                            ["LOG", "├── ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " gains 1 additional resource from {{$THIS.currentFace.name}}."],
                            ["INCREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1]
                        ]
                    }
                }
            },
            "51223bd0-ffd1-11df-a976-0801210c9012": {
                "_comment": "Resourceful",
                "inheritFrom": "attachedHeroGainsOneResourceInResourcePhase"
            },
            "b1cc99c3-09a7-4418-85c4-e368f44adf1d": {
                "_comment": "Necklace of Girion (doesn't use inheritFrom because it conflicts with attachment automation)",
                "rules": {
                    "collectAdditionalResource": {
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", 
                            ["EQUAL", "$GAME.stepId", "1.R"], 
                            ["EQUAL", "$THIS.currentSide", "A"],
                            ["EQUAL", "$THIS.inPlay", true],
                            ["GREATER_THAN", "$THIS.cardIndex", 0]
                        ],
                        "then": [
                            ["LOG", "├── ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " gains 1 additional resource from {{$THIS.currentFace.name}}."],
                            ["INCREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1]
                        ]
                    }
                }
            },
            "59201982-0c04-45a4-8675-755f90932b88": {
                "_comment": "Bilbo's Spoons",
                "inheritFrom": "attachedHeroGainsOneResourceInResourcePhase"
            },
            "51223bd0-ffd1-11df-a976-0801200c9072": {
                "_comment": "Self Preservation",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.damage", 0]
                        ],
                        [
                            ["LOG", "└── ", "Healed 2 damage from ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["HEAL", "$THIS.parentCardId", 2]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "74522565-cb89-4a49-aee0-66840fd077e5": {
                "_comment": "Pint",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.damage", 0]
                        ],
                        [
                            ["LOG", "└── ", "Healed 1 damage from ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["HEAL", "$THIS.parentCardId", 1]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "aaea207b-e0af-4865-89c9-16985543ef9a": {
                "_comment": "Heightened Stature (Boon)",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.damage", 0]
                        ],
                        [
                            ["LOG", "└── ", "Healed 1 damage from ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["HEAL", "$THIS.parentCardId", 1]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801200c9026": {
                "_comment": "Steward of Gondor",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["LOG", "└── ", "Added 2 resources to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["INCREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 2]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "7ce49caa-c7ac-455e-b35f-217055be34ed": {
                "_comment": "Steward of Gondor",
                "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9026"
            },
            "aef31639-1962-4d41-912c-bea70e1be83e": {
                "_comment": "Steward of Gondor",
                "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9026"
            },
            "exhaustToAddOneResourceToAttachedCharacter": {
                "abstract": true,
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["LOG", "└── ", "Added 1 resource to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["INCREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "8a6566b1-2425-442b-8e44-f8a3aa4590fe": {
                "_comment": "Sword of Numenor",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "51223bd0-ffd1-11df-a976-0801211c9019": {
                "_comment": "Love of Tales",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "e6ee53f4-36e4-4671-9d76-8974134d052e": {
                "_comment": "Keys of Orthanc",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "5d1c8757-7409-41da-9e12-454af06e8946": {
                "_comment": "The Day's Rising",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "5c6b9d23-79fe-482c-8122-66b185cd476e": {
                "_comment": "Rune-master",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "9ccbe47b-b30f-468a-a867-60314e3b5d61": {
                "_comment": "Dwarven Shield",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "1cb9b7ce-c138-4de6-b983-68485fb4ea0b": {
                "_comment": "Red Book of Westmarch",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "3892b2e4-358c-42af-b5be-2f54d252ea2a": {
                "_comment": "Leader of Men (Boon)",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "bcc1ca6e-5bd7-48ec-99ee-bbec6e78e7ed": {
                "_comment": "Beorn's Welcome",
                "inheritFrom": "exhaustToAddOneResourceToAttachedCharacter"
            },
            "51223bd0-ffd1-11df-a976-0801200c9045": {
                "_comment": "Northern Tracker",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["NOT", "$THIS.exhausted"],
                            ["NOT", "$THIS.committed"],
                            "$THIS.inPlay"
                        ],
                        [
                            ["LOG", "└── ", "Northern Tracker added 1 progress to each location in the staging area."],
                            ["ACTION_LIST", "toggleCommit"],
                            ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                                ["COND",
                                    ["AND", ["EQUAL", "$CARD.groupId", "sharedStagingArea"], ["EQUAL", "$CARD.currentFace.type", "Location"]],
                                    ["INCREASE_VAL", "/cardById/$CARD_ID/tokens/progress", 1]
                                ]]
                            ]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "exhaustToReadyAttachedCharacter": {
                "abstract": true,
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"],
                            "$GAME.cardById.{{$THIS.parentCardId}}.exhausted"
                        ],
                        [
                            ["LOG", "└── ", "Exhausted ", "$THIS.currentFace.name", " to ready ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["SET", "/cardById/$THIS.id/rotation", 90],
                            ["SET", "/cardById/$THIS.id/exhausted", true],
                            ["SET", "/cardById/$THIS.parentCardId/rotation", 0],
                            ["SET", "/cardById/$THIS.parentCardId/exhausted", false]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "51223bd0-ffd1-11df-a976-0801200c9057": {
                "_comment": "Unexpected Courage",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "e718605c-622d-4fd5-b1a1-b9fe467f09c5": {"_comment": "Unexpected Courage", "inheritFrom": "51223bd0-ffd1-11df-a976-0801200c9057"},
            "51223bd0-ffd1-11df-a976-0801205c9006": {
                "_comment": "Fast Hitch",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "6f8508d7-bb11-4d5c-a077-80a35e00105e": {
                "_comment": "Rohan Warhorse",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "0dfb0828-62d4-4f53-b6fe-600b524f84e1": {"_comment": "Rohan Warhorse", "inheritFrom": "6f8508d7-bb11-4d5c-a077-80a35e00105e"},
            "83842580-bfe9-4d56-addf-e1d290eb7bcf": {
                "_comment": "Heir of Mardil",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "ed245036-ca8c-4ed7-8441-4b2019263bf5": {"_comment": "Heir of Mardil", "inheritFrom": "83842580-bfe9-4d56-addf-e1d290eb7bcf"},
            "e7df2c09-6d38-4f92-9279-eba5f41370cd": {
                "_comment": "Steed of the North",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "f347a30b-44d9-4ddd-af69-798e96b68b65": {
                "_comment": "Leather Boots",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "17cb8a9a-6369-4ea9-a614-02908bd7b77f": {
                "_comment": "Wingfoot",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "c155a832-e771-4f51-8c99-7356babb84b1": {"_comment": "Wingfoot", "inheritFrom": "17cb8a9a-6369-4ea9-a614-02908bd7b77f"},
            "9f61eee8-cff2-43ad-8f82-7c4efb5ed9b8": {
                "_comment": "Shadowfax",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "4a2566d3-9af7-455a-bb5a-d9dafe62c636": {
                "_comment": "Anduril (ALeP)",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "77721e76-80a6-41b0-a71a-9cd533954250": {
                "_comment": "Onward Into Battle",
                "inheritFrom": "exhaustToReadyAttachedCharacter"
            },
            "51223bd0-ffd1-11df-a976-1801204c9024": {
                "_comment": "Cram",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            "$GAME.cardById.{{$THIS.parentCardId}}.exhausted"
                        ],
                        [
                            ["LOG", "└── ", "Discarded ", "$THIS.currentFace.name", " to ready ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", "."],
                            ["SET", "/cardById/$THIS.parentCardId/rotation", 0],
                            ["SET", "/cardById/$THIS.parentCardId/exhausted", false],
                            ["ACTION_LIST", "discardCard"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "0f99cc6c-df9e-4f9e-9f60-87ddb1685b63": {"_comment": "Cram", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9024"},
            "914e9832-60fb-4726-b44b-232c4b5bbead": {"_comment": "Cram", "inheritFrom": "51223bd0-ffd1-11df-a976-1801204c9024"},
            "f86ea37a-d70d-4ff2-ac36-2a0ff1f7ffa9": {
                "_comment": "Lembas",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["OR",
                                "$GAME.cardById.{{$THIS.parentCardId}}.exhausted",
                                ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.damage", 0]
                            ]
                        ],
                        [
                            ["LOG", "└── ", "Discarded ", "$THIS.currentFace.name", " to ready ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " and heal 3 damage from it."],
                            ["SET", "/cardById/$THIS.parentCardId/rotation", 0],
                            ["SET", "/cardById/$THIS.parentCardId/exhausted", false],
                            ["HEAL", "$THIS.parentCardId", 3],
                            ["ACTION_LIST", "discardCard"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "9fa0e4f8-4abf-4552-bb46-94c4b1f0bc15": {"_comment": "Lembas", "inheritFrom": "f86ea37a-d70d-4ff2-ac36-2a0ff1f7ffa9"},
            "28938e58-2900-45d9-b9d9-7d05b7088cc9": {"_comment": "Lembas", "inheritFrom": "f86ea37a-d70d-4ff2-ac36-2a0ff1f7ffa9"},
            "f0ceca81-907d-4c7f-a8e3-0842bf11b80d": {
                "_comment": "Relic of Nargothrond",
                "ability": {
                    "A": ["COND",
                        ["GREATER_THAN", "$THIS.cardIndex", 0],
                        [
                            ["LOG", "└── ", "Discarded ", "$THIS.currentFace.name", " to add 2 defense to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " until the end of the phase."],
                            ["ADD_TEMP_TOKEN", "phase", "$THIS.parentCardId", "defense", 2],
                            ["ACTION_LIST", "discardCard"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "29b76593-0ef3-410b-aa85-1c282d4b1582": {
                "_comment": "Captain of Gondor",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["LOG", "└── ", "Added 1 attack and 1 defense to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " until the end of the round."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["ADD_TEMP_TOKEN", "round", "$THIS.parentCardId", "attack", 1],
                            ["ADD_TEMP_TOKEN", "round", "$THIS.parentCardId", "defense", 1]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "49cc6b92-e841-4a48-af12-484011996695": {"_comment": "Captain of Gondor", "inheritFrom": "29b76593-0ef3-410b-aa85-1c282d4b1582"},
            "69a257ff-3223-4511-a20f-81cb08655081": {
                "_comment": "Song of Hope",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resources", 0]
                        ],
                        [
                            ["LOG", "└── ", "Spent 1 resource to add 1 willpower to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " until the end of the phase."],
                            ["DECREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1],
                            ["ADD_TEMP_TOKEN", "phase", "$THIS.parentCardId", "willpower", 1]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "a7f12d87-5f28-46ca-a301-0ac48ca5e471": {
                "_comment": "Gondorian Fire",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resources", 0]
                        ],
                        [
                            ["VAR", "$RESOURCE_COUNT", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resources"],
                            ["DECREASE_VAR", "$RESOURCE_COUNT", 1],
                            ["LOG", "└── ", "Spent 1 resource to add {{$RESOURCE_COUNT}} attack to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " until the end of the phase."],
                            ["DECREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1],
                            ["ADD_TEMP_TOKEN", "phase", "$THIS.parentCardId", "attack", "$RESOURCE_COUNT"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "4823aae3-46ef-4a75-89f9-cbd3aa1b9007": {
                "_comment": "Blood of Numenor",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["GREATER_THAN", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resources", 0]
                        ],
                        [
                            ["VAR", "$RESOURCE_COUNT", "$GAME.cardById.{{$THIS.parentCardId}}.tokens.resources"],
                            ["DECREASE_VAR", "$RESOURCE_COUNT", 1],
                            ["LOG", "└── ", "Spent 1 resource to add {{$RESOURCE_COUNT}} defense to ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " until the end of the phase."],
                            ["DECREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1],
                            ["ADD_TEMP_TOKEN", "phase", "$THIS.parentCardId", "defense", "$RESOURCE_COUNT"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "94f6738a-c946-4415-9b38-0ce3a443fa33": {
                "_comment": "Treebeard (Hero)",
                "ability": {
                    "A": [
                            ["LOG", "└── ", "Dealt 1 damage to ", "$THIS.currentFace.name", " to add 1 willpower and 1 attack until the end of the phase."],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/damage", 1],
                            ["ADD_TEMP_TOKEN", "phase", "$THIS_ID", "willpower", 1],
                            ["ADD_TEMP_TOKEN", "phase", "$THIS_ID", "attack", 1]
                        ]
                }
            },
            "21cfb9e9-6777-4bc6-ace6-08fe68e949a4": {
                "_comment": "Éomer (Hero, Tactics)",
                "ability": {
                    "A": [
                            ["LOG", "└── ", "Added 2 attack to ", "$THIS.currentFace.name", " until the end of the round."],
                            ["TOGGLE_EXHAUST", "$THIS"],
                            ["ADD_TEMP_TOKEN", "round", "$THIS_ID", "attack", 2]
                        ]
                }
            },
            "e87c3473-e107-40dd-9af7-b01f35176ea0": {
                "_comment": "Éomer (Hero, Tactics)",
                "inheritFrom": "21cfb9e9-6777-4bc6-ace6-08fe68e949a4"
            },
            "c984e8e8-94a6-4af6-9455-824ad2cf46f9": {
                "_comment": "Magic Ring",
                "ability": {
                    "A": ["COND",
                        ["AND", 
                            ["GREATER_THAN", "$THIS.cardIndex", 0],
                            ["NOT", "$THIS.exhausted"]
                        ],
                        [
                            ["VAR", "$PARENT_CARD", "$GAME.cardById.{{$THIS.parentCardId}}"],
                            ["LOG", "└── ", "Raised threat by 1."],
                            ["COND",
                                ["AND", ["NOT", "$PARENT_CARD.exhausted"], ["EQUAL", "$PARENT_CARD.tokens.damage", 0]],
                                [
                                    ["LOG", "└── ", "Added a resource to ", "$PARENT_CARD.currentFace.name","."],
                                    ["INCREASE_VAL", "/cardById/$THIS.parentCardId/tokens/resource", 1]
                                ],
                                ["TRUE"],
                                [
                                    ["PROMPT", "$PLAYER_N", "basePrompt", "Choose an option"],
                                    ["COND",
                                        ["GREATER_THAN", "$GAME.cardById.{{$PARENT_CARD.id}}.tokens.damage", 0],
                                        ["PROMPT_ADD_OPTION", "$PLAYER_N", "Heal 1 damage", "1", ["REPLACE_STRING_IN_LIST", ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                            ["LOG", "└── ", "Healed 1 damage from PARENT_CARD_NAME."],
                                            ["DECREASE_VAL", "/cardById/{{PARENT_CARD_ID}}/tokens/damage", 1]
                                        ]], "PARENT_CARD_NAME", "$PARENT_CARD.currentFace.name"], "PARENT_CARD_ID", "$PARENT_CARD.id"]
                                        ]
                                    ],
                                    ["PROMPT_ADD_OPTION", "$PLAYER_N", "Add 1 resource", "2", ["REPLACE_STRING_IN_LIST", ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                        ["LOG", "└── ", "Added 1 resource to PARENT_CARD_NAME."],
                                        ["INCREASE_VAL", "/cardById/{{PARENT_CARD_ID}}/tokens/resource", 1]
                                    ]], "PARENT_CARD_NAME", "$PARENT_CARD.currentFace.name"], "PARENT_CARD_ID", "$PARENT_CARD.id"]
                                    ],
                                    ["COND",
                                        "$PARENT_CARD.exhausted",
                                        ["PROMPT_ADD_OPTION", "$PLAYER_N", "Ready hero", "3", ["REPLACE_STRING_IN_LIST", ["REPLACE_STRING_IN_LIST", ["POINTER", [
                                            ["LOG", "└── ", "Readied PARENT_CARD_NAME."],
                                            ["SET", "/cardById/{{PARENT_CARD_ID}}/rotation", 0],
                                            ["SET", "/cardById/{{PARENT_CARD_ID}}/exhausted", false]
                                        ]], "PARENT_CARD_NAME", "$PARENT_CARD.currentFace.name"], "PARENT_CARD_ID", "$PARENT_CARD.id"]
                                        ]
                                    ]
                                ]
                            ],
                            ["INCREASE_VAL", "/playerData/{{$THIS.controller}}/threat", 1],
                            ["TOGGLE_EXHAUST", "$THIS"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "fa030621-5b1d-4955-8d5e-3e515f546981": {"_comment": "Magic Ring", "inheritFrom": "c984e8e8-94a6-4af6-9455-824ad2cf46f9"},
            "51223bd0-ffd1-11df-a976-0801205c9002": {
                "_comment": "Boromir (Hero, Tactics)",
                "ability": {
                    "A": ["COND",
                        ["$THIS.exhausted"],
                        [
                            ["LOG", "└── ", "Raised threat by 1 to ready Boromir."],
                            ["INCREASE_VAL", "/playerData/{{$THIS.controller}}/threat", 1],
                            ["TOGGLE_EXHAUST", "$THIS"]
                        ],
                        ["TRUE"],
                        ["LOG", "└── ", "The ability's conditions are not met."]
                    ]
                }
            },
            "parentCardGainsHeroType": {
                "abstract": true,
                "rules": {
                    "makeIntoHero": {
                        "type": "trigger",
                        "autoRun": {
                            "status": "promptYN",
                            "promptPlayerI": "$THIS.controller",
                            "promptMessage": "Grant the hero type to {{$THIS.parentCard.sides.A.name}}?"
                        },
                        "listenTo": ["/cardById/$THIS_ID/cardIndex"],
                        "condition": ["GREATER_THAN", "$THIS.cardIndex", 0],
                        "then": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["LOG", "{{$ALIAS}} gave the hero type to {{$THIS.parentCard.sides.A.name}}."],
                            ["SET", "/cardById/$THIS.parentCardId/sides/A/type", "Hero"]
                        ]
                    }
                }
            },
            "1200dd24-3d0a-485d-baa3-6eac91f87779": {
                "_comment": "Messenger of the King",
                "inheritFrom": "parentCardGainsHeroType"
            },
            "59cd2c5f-1986-4065-ad2c-8423d6b200e2": {
                "_comment": "Sword-thain",
                "inheritFrom": "parentCardGainsHeroType"
            },
            "a4a86a9e-050a-4df4-9403-04bf68a7dc99": {
                "_comment": "Word of Persuasion",
                "rules": {
                    "makeIntoAlly": {
                        "type": "passive",
                        "listenTo": ["/cardById/$THIS_ID/cardIndex"],
                        "condition": ["GREATER_THAN", "$THIS.cardIndex", 0],
                        "onDo": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", ["PREV", "$THIS.controller"]]],
                            ["LOG", "{{$ALIAS}} gave the ally type to {{$THIS.parentCard.sides.A.name}}."],
                            ["SET", "/cardById/$THIS.parentCardId/sides/A/type", "Ally"]
                        ],
                        "offDo": [
                            ["VAR", "$ALIAS", ["GET_ALIAS", "$THIS.controller"]],
                            ["VAR", "$PREV_PARENT", ["PREV", "$THIS.parentCard"]],
                            ["LOG", "{{$ALIAS}} removed the ally type from {{$PREV_PARENT.sides.A.name}}."],
                            ["SET", "/cardById/{{$PREV_PARENT.id}}/sides/A/type", "Enemy"]
                        ]
                    }
                }
            },
            "3e055edf-4540-4cf1-94ce-afbf5fc28f82": {
                "_comment": "Hero Gandalf",
                // "ability": {
                //     "A": [
                //         ["COND",
                //             ["NOT_EQUAL", "$THIS.abilityEnabled", true],
                //             [
                //                 ["LOG", "{{$ALIAS_N}} turned on Gandalf's ability to look at the top card of their deck."],
                //                 ["SET", "/cardById/$THIS_ID/groupIdToPeakAt", "{{$THIS.controller}}Deck"],
                //                 ["SET", "/cardById/$THIS_ID/abiltyEnabled", true]
                //             ],
                //             ["TRUE"],
                //             [
                //                 ["LOG", "{{$ALIAS_N}} turned off Gandalf's ability to look at the top card of their deck."],
                //                 ["SET", "/cardById/$THIS_ID/groupIdToPeakAt", ""],
                //                 ["SET", "/cardById/$THIS_ID/abiltyEnabled", false]
                //             ]
                //         ]
                //     ]
                // },
                "rules": {
                    "flipTopCardFaceup": {
                        "type": "trigger",
                        "listenTo": ["/cardById/$THIS_ID/inPlay", "/cardById/$THIS_ID/currentSide", "/groupById/player1Deck/stackIds", "/groupById/player2Deck/stackIds", "/groupById/player3Deck/stackIds", "/groupById/player4Deck/stackIds"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$THIS.currentSide", "A"]],
                        "then": [
                            ["VAR", "$GROUP_ID", "{{$THIS.controller}}Deck"],
                            ["UNSET", "/groupById/$GROUP_ID/onCardEnter/currentSide"],
                            ["VAR", "$PARENT_CARD_IDS", "$GAME.groupById.{{$GROUP_ID}}.parentCardIds"],
                            ["FOR_EACH_VAL", "$PARENT_CARD_ID", "$PARENT_CARD_IDS", [
                                ["COND",
                                    ["EQUAL", "$GAME.cardById.$PARENT_CARD_ID.currentSide", "A"],
                                    ["SET", "/cardById/$PARENT_CARD_ID/currentSide", "B"]
                                ]
                            ]],
                            ["VAR", "$CARD_COUNT", ["LENGTH", "$PARENT_CARD_IDS"]],
                            ["COND",
                                ["GREATER_THAN", "$CARD_COUNT", 0],
                                [
                                    ["VAR", "$TOP_CARD_ID", ["GET_CARD_ID", "$GROUP_ID", 0, 0]],
                                    ["SET", "/cardById/$TOP_CARD_ID/currentSide", "A"]
                                ]
                            ]
                        ]
                    }
                }
            }
        }
    }
}