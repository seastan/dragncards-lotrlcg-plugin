{
    "automation": {
        "cards": {
            "31c2ec5f-c9ac-40be-b91c-1f9ff9b7ec82": {
                "_comment": "Setup",
                "rules": {
                    "setup": {
                        "type": "entersPlay",
                        "side": "A",
                        "then": [
                            ["SET", "/groupById/sharedExtra1/onCardEnter/currentSide", "B"],
                            ["SET", "/groupById/sharedExtra1/onCardEnter/discardGroupId", "sharedEncounterDeck"],
                            ["SET", "/groupById/sharedExtra1/shuffleOnLoad", true],
                            ["SET", "/groupById/sharedExtra2/onCardEnter/currentSide", "B"],
                            ["SET", "/groupById/sharedExtra2/onCardEnter/discardGroupId", "sharedEncounterDeck"],
                            ["SET", "/groupById/sharedExtra2/shuffleOnLoad", true],
                            ["SET", "/groupById/sharedExtra3/onCardEnter/currentSide", "B"],
                            ["SET", "/groupById/sharedExtra3/onCardEnter/discardGroupId", "sharedEncounterDeck"],
                            ["SET", "/groupById/sharedExtra3/shuffleOnLoad", true],
                            ["PROMPT", "player1", "mirrorOfGaladrielScenario"],
                            ["PROMPT", "player1", "mirrorOfGaladrielWave1"],
                            ["PROMPT", "player1", "mirrorOfGaladrielWave2"],
                            ["PROMPT", "player1", "mirrorOfGaladrielVillain"]
                        ]
                    }
                }
            }
        }
    },
    "functions": {
        "LOAD_MIRROR_WAVE": {
          "args": ["$ENCOUNTER_SET", "$EXTRA_GROUP_ID"],
          "code": [
                ["VAR", "$GROUP_ID", "sharedExtra1"],
                ["VAR", "$CONDITION", ["POINTER", ["AND",
                    ["IN_STRING", "$CARD_DETAILS.A.encounterSet", "$ENCOUNTER_SET"]
                ]]],
                ["LOAD_CARDS_BY_CONDITION", "$EXTRA_GROUP_ID", "$CONDITION"],
                ["MOVE_CARD_BY_NAME_AND_TYPE", "$ENCOUNTER_SET", "Objective", "sharedStagingArea", -1]
            ]
        }
    },
    "prompts": {
        "mirrorOfGaladrielScenario": {
            "args": [],
            "message": "Choose a Scenario set",
            "options": [
                {
                    "label": "Minas Tirith",
                    "code": [
                        ["MOVE_STACKS", "sharedEncounterDeck", "sharedEncounterDeck2"],
                        ["FOR_EACH_VAL", "$CARD", "$GAME.groupById.sharedEncounterDeck2.parentCards", [
                            ["COND",
                                ["IN_STRING", "$CARD.sides.A.traits", "Minas Tirith"],
                                ["MOVE_CARD", "$CARD.id", "sharedEncounterDeck", 0]
                            ]
                        ]],
                        ["SHUFFLE_GROUP", "sharedEncounterDeck"],
                        ["MOVE_CARD_BY_NAME", "The Ring Comes to Gondor", "sharedStagingArea", -1],
                        ["MOVE_CARD_BY_NAME", "The One Ring", "sharedStagingArea", -1]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        },
        "mirrorOfGaladrielWave1": {
            "args": [],
            "message": "Choose a Wave 1 set",
            "options": [
                {
                    "label": "Mirkwood Foes",
                    "code": [
                        ["VAR", "$CONDITION", ["POINTER", ["AND",
                            ["IN_STRING", "$CARD_DETAILS.A.encounterSet", "Dol Guldur Orcs"]
                        ]]],
                        ["LOAD_CARDS_BY_CONDITION", "sharedExtra1", "$CONDITION"],
                        ["VAR", "$CONDITION", ["POINTER", ["AND",
                            ["IN_STRING", "$CARD_DETAILS.A.encounterSet", "Spiders of Mirkwood"]
                        ]]],
                        ["LOAD_CARDS_BY_CONDITION", "sharedExtra1", "$CONDITION"],
                        ["MOVE_CARD_BY_NAME_AND_TYPE", "Mirkwood Foes", "Objective", "sharedStagingArea", -1],
                        ["FOR_EACH_VAL", "$CARD", "$GAME.groupById.sharedExtra1.parentCards", [
                            ["COND",
                                ["NOT_EQUAL", "$CARD.sides.A.type", "Enemy"],
                                ["DELETE_CARD", "$CARD.id"]
                            ]
                        ]],
                        ["MOVE_CARD_BY_NAME", "Chieftan Ufthak", "sharedSetAside", -1]
                    ]
                },
                {
                    "label": "Wild Creatures",
                    "code": ["LOAD_MIRROR_WAVE", "Wild Creatures", "sharedExtra1"]
                },
                {
                    "label": "Plundering Goblins",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Plundering Goblins", "sharedExtra1"],
                        ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.groupById.sharedExtra1.parentCards", [
                            ["COND",
                                ["OR",
                                    ["EQUAL", "$CARD.sides.A.name", "Undisturbed Bones"],
                                    ["EQUAL", "$CARD.sides.A.name", "Plundered Armoury"]
                                ],
                                ["DELETE_CARD", "$CARD_ID"]
                            ]
                        ]]
                    ]
                },
                {
                    "label": "Ravaging Orcs",
                    "code": ["LOAD_MIRROR_WAVE", "Ravaging Orcs", "sharedExtra1"]
                },
                {
                    "label": "Brigands",
                    "code": ["LOAD_MIRROR_WAVE", "Brigands", "sharedExtra1"]
                },
                {
                    "label": "Misty Mountain Orcs",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Misty Mountain Orcs", "sharedExtra1"],
                        ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.groupById.sharedExtra1.parentCards", [
                            ["COND",
                                ["EQUAL", "$CARD.sides.A.name", "Orc Hunting Party"],
                                ["DELETE_CARD", "$CARD_ID"]
                            ]
                        ]]
                    ]
                },
                {
                    "label": "Harad Foes",
                    "code": [
                        ["LOAD_CARDS", ["LIST",
                            {"databaseId": "a34ffb4e-c821-42aa-8dab-2914d274b3b1", "loadGroupId": "sharedExtra1", "quantity": 3},
                            {"databaseId": "6cfc4fa5-bbcc-4c99-82b7-bb6359d24750", "loadGroupId": "sharedExtra1", "quantity": 3},
                            {"databaseId": "04a23a2e-a14f-4c54-b54f-eeef36d3a92b", "loadGroupId": "sharedExtra1", "quantity": 3}
                        ]],
                        ["MOVE_CARD_BY_NAME_AND_TYPE", "Harad Foes", "Objective", "sharedStagingArea", -1]
                    ]
                },
                {
                    "label": "Orcs of Mordor",
                    "code": ["LOAD_MIRROR_WAVE", "Orcs of Mordor", "sharedExtra1"]
                },
                {
                    "label": "Dunland Warriors",
                    "code": ["LOAD_MIRROR_WAVE", "Dunland Warriors", "sharedExtra1"]
                },
                {
                    "label": "Dunlending Warriors",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Dunlending Warriors", "sharedExtra1"],
                        ["MOVE_CARD_BY_NAME", "Dunland Chieftain", "sharedSetAside", -1]
                    ]
                },
                {
                    "label": "Wolf-cult",
                    "code": ["LOAD_MIRROR_WAVE", "Wolf-cult", "sharedExtra1"]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        },
        "mirrorOfGaladrielWave2": {
            "args": [],
            "message": "Choose a Wave 2 set",
            "options": [
                {
                    "label": "The Nazgûl",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "The Nazgûl", "sharedExtra2"],
                        ["MOVE_CARD_BY_NAME", "The Witch-king", "sharedSetAside", -1]
                    ]
                },
                {
                    "label": "Cursed Dead",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Cursed Dead", "sharedExtra2"],
                        ["MOVE_CARD_BY_NAME", "Seal the Tomb", "sharedEncounterDeck2", -1]
                    ]
                },
                {
                    "label": "Dunland Raiders",
                    "code": ["LOAD_MIRROR_WAVE", "Dunland Raiders", "sharedExtra2"]
                }, 
                {
                    "label": "Drowned Dead",
                    "code": ["LOAD_MIRROR_WAVE", "Drowned Dead", "sharedExtra2"]
                }, 
                {
                    "label": "Easterling Raiders",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Easterling Raiders", "sharedExtra2"],
                        ["MOVE_CARD_BY_NAME", "Warriors of the East", "sharedEncounterDeck2", -1]
                    ]
                },
                {
                    "label": "Angmar Orcs",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Angmar Orcs", "sharedExtra2"],
                        ["MOVE_CARD_BY_NAME", "Orc Ambush", "sharedEncounterDeck2", -1]
                    ]
                },
                {
                    "label": "Corsair Raiders",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Corsair Raiders", "sharedExtra2"],
                        ["LOAD_CARDS", ["LIST",
                            {"databaseId": "97bf780d-cd76-492f-a970-37f78273c5bb", "loadGroupId": "sharedStagingArea", "quantity": 1}
                        ]]
                    ]
                },
                {
                    "label": "Uruk-hai Foes",
                    "code": [
                        ["LOAD_CARDS", ["LIST",
                            {"databaseId": "509f3e41-385c-4b84-ad28-7cc2eed8028c", "loadGroupId": "sharedExtra2", "quantity": 4},
                            {"databaseId": "fed61900-b526-41e6-b072-9c5eae29bc77", "loadGroupId": "sharedExtra2", "quantity": 3},
                            {"databaseId": "8345c4ad-4c5e-484d-bc6f-d1e4bc27805f", "loadGroupId": "sharedExtra2", "quantity": 3}
                        ]],
                        ["MOVE_CARD_BY_NAME_AND_TYPE", "Uruk-hai Foes", "Objective", "sharedStagingArea", -1]
                    ]
                },
                {
                    "label": "Wolves",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Wolves", "sharedExtra2"],
                        ["MOVE_CARD_BY_NAME", "Great Wolf", "sharedSetAside", -1]
                    ]
                },
                {
                    "label": "Orc-host",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Orc-host", "sharedExtra2"],
                        ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.groupById.sharedExtra2.parentCards", [
                            ["COND",
                                ["NOT_EQUAL", "$CARD.sides.A.type", "Enemy"],
                                ["DELETE_CARD", "$CARD_ID"]
                            ]
                        ]],
                        ["MOVE_CARD_BY_NAME", "Orc Battalion", "sharedExtra2", -1],
                        ["LOG", "{{$ALIAS_N}} placed Orc Battalion on the bottom of the Extra 2 group."]
                    ]
                },
                {
                    "label": "Ruffians",
                    "code": [
                        ["LOAD_MIRROR_WAVE", "Ruffians", "sharedExtra2"],
                        ["MOVE_CARD_BY_NAME", "Ruffians on the Rise", "sharedSetAside", -1]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        },
        "mirrorOfGaladrielVillain": {
            "args": [],
            "message": "Choose a Villain set",
            "options": [
                {
                    "label": "Sauron",
                    "code": [
                        ["FOR_EACH_VAL", "$CARD", "$GAME.groupById.sharedEncounterDeck2.parentCards", [
                            ["COND",
                                ["IN_STRING", "$CARD.sides.A.traits", "Sauron"],
                                ["MOVE_CARD", "$CARD.id", "sharedExtra3", 0]
                            ]
                        ]],
                        ["SHUFFLE_GROUP", "sharedExtra3"],
                        ["MOVE_CARD_BY_NAME", "The Dark Lord Beckons", "sharedStagingArea", -1],
                        ["MOVE_CARD_BY_NAME", "Sauron", "sharedSetAside", -1]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        }
    }
}